const textutil = require('../../game_logic/textutil.js');
const { writeArray } = require('../../../util/binary.js');

function apply(rom, text) {
    rom[0xCE7C1] = 0x68;
    writeArray(rom, 0xCE7C9, [0x60, 0x1, 0x48, 0x0, 0x47, 0x0, 0x0, 0x1, 0xC0, 0xFF, 0x8]);

    writeArray(rom, 0xFFC000, [0x8, 0x48, 0x1, 0x1C, 0x8, 0x88, 0x4, 0x21, 0x8, 0x40, 0x0, 0x28, 0x7, 0xD0, 0xD0, 0x20, 0x0, 0x1, 
        0x66, 0x30, 0x1, 0x21, 0x0, 0xF0, 0xB, 0xF8, 0x4, 0x48, 0x0, 0x47, 0x2, 0x48, 0x0, 0x47, 0x0, 0x0, 0x50, 0x11, 0x0, 0x3, 0xDB, 
        0xE7, 0xC, 0x8, 0xEF, 0xEA, 0xC, 0x8, 0x0, 0x4C, 0x20, 0x47, 0x41, 0x80, 0x3, 0x8]);

    textutil.writeLine(text, 0xD66, "Retreat glitch activated.\x02");
}

module.exports = {apply};